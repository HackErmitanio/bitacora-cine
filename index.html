<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Escena 24</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0b1c2d;
  color: #fff;
}

header {
  padding: 25px;
  text-align: center;
  background: #071421;
}

header h1 {
  margin: 0;
}

header p {
  opacity: .8;
}

input {
  width: 90%;
  max-width: 500px;
  padding: 12px;
  font-size: 16px;
  margin-top: 15px;
  border-radius: 6px;
  border: none;
}

section {
  padding: 25px;
}

h2 {
  border-bottom: 1px solid #1e3a5f;
  padding-bottom: 6px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 18px;
}

.card img {
  width: 100%;
  border-radius: 10px;
  cursor: pointer;
  transition: transform .2s;
}

.card img:hover {
  transform: scale(1.06);
}

/* Modal */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.92);
  display: none;
  overflow-y: auto;
}

.modal-content {
  max-width: 900px;
  margin: 40px auto;
  background: #071421;
  padding: 25px;
  border-radius: 12px;
}

.modal img {
  width: 220px;
  float: left;
  margin-right: 25px;
  border-radius: 12px;
}

.close {
  float: right;
  font-size: 26px;
  cursor: pointer;
}

.stars span {
  font-size: 26px;
  cursor: pointer;
  color: gray;
}

.stars span.active {
  color: gold;
}

textarea {
  width: 100%;
  min-height: 90px;
  margin-top: 10px;
}

button {
  padding: 10px 15px;
  background: #1e90ff;
  border: none;
  color: white;
  cursor: pointer;
  margin-top: 10px;
}
</style>
</head>

<body>

<header>
  <h1>üé¨ Escena 24</h1>
  <p>Cine, series, anime y cultura cinematogr√°fica</p>
  <input id="search" placeholder="Buscar en todo el cat√°logo...">
</header>

<section>
  <h2>üîé Resultados de b√∫squeda</h2>
  <div class="grid" id="searchResults"></div>
</section>

<section>
  <h2>üéû Cine cl√°sico y de autor</h2>
  <div class="grid" id="classic"></div>
</section>

<section>
  <h2>üì∫ Series</h2>
  <div class="grid" id="series"></div>
</section>

<section>
  <h2>üéå Anime</h2>
  <div class="grid" id="anime"></div>
</section>

<section>
  <h2>üé• Cine contempor√°neo</h2>
  <div class="grid" id="modern"></div>
</section>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">‚úñ</span>
    <img id="modalImg">
    <h2 id="modalTitle"></h2>
    <p id="modalInfo"></p>
    <p id="modalOverview"></p>

    <h3>‚≠ê Tu puntuaci√≥n</h3>
    <div class="stars" id="stars"></div>

    <h3>‚úç Rese√±a</h3>
    <textarea id="review"></textarea>
    <button onclick="saveReview()">Guardar rese√±a</button>
  </div>
</div>

<script>
const API_KEY = "5b4ad82505bd1853a5256c1db2d4b330";
const IMG = "https://image.tmdb.org/t/p/w500";

const classic = document.getElementById("classic");
const series = document.getElementById("series");
const anime = document.getElementById("anime");
const modern = document.getElementById("modern");
const searchResults = document.getElementById("searchResults");

function fetchSection(url, container) {
  fetch(url)
    .then(r => r.json())
    .then(data => {
      data.results.forEach(item => {
        if (!item.poster_path) return;
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `<img src="${IMG + item.poster_path}">`;
        div.onclick = () => openModal(item);
        container.appendChild(div);
      });
    });
}

/* Cargar cat√°logo base */
fetchSection(`https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&language=es-MX&sort_by=popularity.desc&primary_release_date.lte=1985`, classic);

fetchSection(`https://api.themoviedb.org/3/discover/tv?api_key=${API_KEY}&language=es-MX&sort_by=popularity.desc`, series);

fetchSection(`https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&language=es-MX&with_genres=16`, anime);

fetchSection(`https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&language=es-MX&primary_release_date.gte=2000`, modern);

/* B√∫squeda */
document.getElementById("search").addEventListener("keyup", e => {
  if (e.key === "Enter") {
    searchResults.innerHTML = "";
    fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&language=es-MX&query=${e.target.value}`)
      .then(r => r.json())
      .then(data => {
        data.results.forEach(item => {
          if (!item.poster_path) return;
          const div = document.createElement("div");
          div.className = "card";
          div.innerHTML = `<img src="${IMG + item.poster_path}">`;
          div.onclick = () => openModal(item);
          searchResults.appendChild(div);
        });
      });
  }
});

/* Modal */
function openModal(item) {
  document.getElementById("modal").style.display = "block";
  document.getElementById("modalImg").src = IMG + item.poster_path;
  document.getElementById("modalTitle").innerText = item.title || item.name;
  document.getElementById("modalOverview").innerText = item.overview || "Sin descripci√≥n";

  const year = (item.release_date || item.first_air_date || "").split("-")[0];
  document.getElementById("modalInfo").innerText = `${item.media_type || "CAT√ÅLOGO"} ¬∑ ${year}`;

  loadStars(item.id);
  loadReview(item.id);
}

function closeModal() {
  document.getElementById("modal").style.display = "none";
}

/* Rating */
function loadStars(id) {
  const c = document.getElementById("stars");
  c.innerHTML = "";
  let saved = localStorage.getItem("rating_" + id) || 0;

  for (let i = 1; i <= 5; i++) {
    const s = document.createElement("span");
    s.innerText = "‚òÖ";
    if (i <= saved) s.classList.add("active");
    s.onclick = () => {
      localStorage.setItem("rating_" + id, i);
      loadStars(id);
    };
    c.appendChild(s);
  }
}

/* Rese√±as */
function saveReview() {
  const title = document.getElementById("modalTitle").innerText;
  localStorage.setItem("review_" + title, document.getElementById("review").value);
  alert("Rese√±a guardada");
}

function loadReview(id) {
  document.getElementById("review").value = localStorage.getItem("review_" + id) || "";
}
</script>

</body>
</html>












