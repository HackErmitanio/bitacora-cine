<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Escena 24</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0b1c2d;
  color: white;
}

header {
  background: #071421;
  padding: 20px;
  text-align: center;
}

nav {
  display: flex;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap;
  margin-top: 10px;
}

nav a {
  color: #9fc5ff;
  text-decoration: none;
  font-weight: bold;
}

nav a:hover {
  text-decoration: underline;
}

main {
  padding: 25px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 20px;
}

.card img {
  width: 100%;
  border-radius: 10px;
  cursor: pointer;
  transition: transform .2s;
}

.card img:hover {
  transform: scale(1.05);
}

h2 {
  border-bottom: 1px solid #1e3a5f;
  padding-bottom: 5px;
}

.detail {
  max-width: 900px;
  margin: auto;
}

.detail img {
  width: 260px;
  border-radius: 12px;
  float: left;
  margin-right: 25px;
}

.stars span {
  font-size: 26px;
  cursor: pointer;
  color: gray;
}

.stars span.active {
  color: gold;
}

textarea {
  width: 100%;
  min-height: 100px;
}

button {
  padding: 10px 15px;
  margin-top: 10px;
  background: #1e90ff;
  border: none;
  color: white;
  cursor: pointer;
}
</style>
</head>

<body>

<header>
  <h1>üé¨ Escena 24</h1>
  <p>Cine, series, anime y cultura cinematogr√°fica</p>

  <nav>
    <a href="#new">Pel√≠culas nuevas</a>
    <a href="#anime">Anime</a>
    <a href="#series">Series</a>
    <a href="#classic">Pel√≠culas cl√°sicas</a>
    <a href="#mexico">Cine de Oro Mexicano</a>
  </nav>
</header>

<main id="app"></main>

<script>
const API_KEY = "5b4ad82505bd1853a5256c1db2d4b330";
const IMG = "https://image.tmdb.org/t/p/w500";
const app = document.getElementById("app");

/* ---------------- ROUTER ---------------- */
window.addEventListener("load", router);
window.addEventListener("hashchange", router);

function router() {
  const hash = location.hash;

  if (hash.startsWith("#movie/") || hash.startsWith("#tv/")) {
    const [type, id] = hash.replace("#","").split("/");
    renderDetail(type, id);
  } else {
    renderCategory(hash.replace("#","") || "new");
  }
}

/* ---------------- CATEGOR√çAS ---------------- */
const categories = {
  new: `discover/movie?primary_release_date.gte=2022`,
  anime: `discover/movie?with_genres=16`,
  series: `discover/tv`,
  classic: `discover/movie?primary_release_date.lte=1980`,
  mexico: `discover/movie?with_original_language=es&primary_release_date.lte=1970`
};

function renderCategory(cat) {
  app.innerHTML = `<h2>${getTitle(cat)}</h2><div class="grid" id="grid"></div>`;
  loadAllPages(cat, 1);
}

function loadAllPages(cat, page) {
  const url = `https://api.themoviedb.org/3/${categories[cat]}&api_key=${API_KEY}&language=es-MX&page=${page}`;
  fetch(url)
    .then(r => r.json())
    .then(data => {
      const grid = document.getElementById("grid");
      data.results.forEach(item => {
        if (!item.poster_path) return;
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `<img src="${IMG + item.poster_path}">`;
        div.onclick = () => {
          location.hash = `#${item.media_type || (cat === "series" ? "tv":"movie")}/${item.id}`;
        };
        grid.appendChild(div);
      });
      if (page < data.total_pages && page < 5) {
        loadAllPages(cat, page + 1);
      }
    });
}

function getTitle(cat) {
  return {
    new: "üé• Pel√≠culas nuevas",
    anime: "üéå Anime",
    series: "üì∫ Series",
    classic: "üéû Pel√≠culas cl√°sicas",
    mexico: "üá≤üáΩ Cine de Oro Mexicano"
  }[cat];
}

/* ---------------- DETALLE ---------------- */
function renderDetail(type, id) {
  fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}&language=es-MX`)
    .then(r => r.json())
    .then(data => {
      app.innerHTML = `
        <div class="detail">
          <button onclick="history.back()">‚¨Ö Volver</button>
          <h2>${data.title || data.name}</h2>
          <img src="${IMG + data.poster_path}">
          <p><strong>A√±o:</strong> ${(data.release_date || data.first_air_date || "").slice(0,4)}</p>
          <p><strong>Descripci√≥n:</strong> ${data.overview || "Sin descripci√≥n"}</p>

          <h3>‚≠ê Tu puntuaci√≥n</h3>
          <div class="stars" id="stars"></div>

          <h3>‚úç Rese√±a</h3>
          <textarea id="review"></textarea>
          <button onclick="saveReview(${id})">Guardar rese√±a</button>
        </div>
      `;
      loadStars(id);
      document.getElementById("review").value = localStorage.getItem("review_"+id) || "";
    });
}

/* ---------------- ESTRELLAS ---------------- */
function loadStars(id) {
  const stars = document.getElementById("stars");
  stars.innerHTML = "";
  let rating = localStorage.getItem("rating_"+id) || 0;

  for (let i=1;i<=5;i++) {
    const s = document.createElement("span");
    s.innerText = "‚òÖ";
    if (i <= rating) s.classList.add("active");
    s.onclick = () => {
      localStorage.setItem("rating_"+id, i);
      loadStars(id);
    };
    stars.appendChild(s);
  }
}

/* ---------------- RESE√ëA ---------------- */
function saveReview(id) {
  localStorage.setItem("review_"+id, document.getElementById("review").value);
  alert("Rese√±a guardada");
}
</script>

</body>
</html>










