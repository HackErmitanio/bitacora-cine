<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Escena 24</title>

<style>
:root{
  --bg:#0f0c29;
  --bg2:#302b63;
  --bg3:#24243e;
  --card:#1b1b3a;
  --accent:#ff4ecd;
  --accent2:#00f5d4;
  --text:#ffffff;
}

body{
  margin:0;
  font-family: "Segoe UI", sans-serif;
  background: linear-gradient(120deg,var(--bg),var(--bg2),var(--bg3));
  color:var(--text);
}

header{
  padding:30px;
  text-align:center;
}

header h1{
  margin:0;
  font-size:3rem;
  background: linear-gradient(90deg,var(--accent),var(--accent2));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

header p{
  opacity:.85;
}

nav{
  margin-top:20px;
  display:flex;
  justify-content:center;
  gap:20px;
  flex-wrap:wrap;
}

nav a{
  background:var(--card);
  padding:10px 18px;
  border-radius:30px;
  text-decoration:none;
  color:white;
  font-weight:bold;
  transition:.3s;
}

nav a:hover{
  background:var(--accent);
}

.search-box{
  margin-top:25px;
}

.search-box input{
  width:90%;
  max-width:500px;
  padding:14px;
  border-radius:30px;
  border:none;
  font-size:16px;
  outline:none;
}

main{
  padding:30px;
}

h2{
  margin-bottom:20px;
  color:var(--accent2);
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:22px;
}

.card{
  background:var(--card);
  border-radius:16px;
  padding:10px;
  text-align:center;
  cursor:pointer;
  transition:.3s;
}

.card:hover{
  transform:translateY(-6px);
  box-shadow:0 15px 30px rgba(0,0,0,.5);
}

.card img{
  width:100%;
  border-radius:12px;
}

.card span{
  display:block;
  margin-top:8px;
  font-size:.9rem;
}

/* DETALLE */
.detail{
  max-width:1100px;
  margin:auto;
}

.detail-header{
  display:flex;
  flex-wrap:wrap;
  gap:30px;
}

.detail-header img{
  width:300px;
  border-radius:18px;
}

.detail-info{
  flex:1;
}

.badge{
  display:inline-block;
  background:var(--accent);
  padding:5px 12px;
  border-radius:20px;
  margin-right:8px;
  font-size:.8rem;
}

.stars span{
  font-size:30px;
  cursor:pointer;
  color:#555;
}

.stars span.active{
  color:gold;
}

textarea{
  width:100%;
  min-height:120px;
  border-radius:12px;
  border:none;
  padding:12px;
  font-size:15px;
}

button{
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  border:none;
  padding:12px 20px;
  border-radius:30px;
  color:black;
  font-weight:bold;
  cursor:pointer;
  margin-top:10px;
}
</style>
</head>

<body>

<header>
  <h1>ESCENA 24</h1>
  <p>Cine, series, anime y cultura pop</p>

  <nav>
    <a href="#new">Pel√≠culas nuevas</a>
    <a href="#anime">Anime</a>
    <a href="#series">Series</a>
    <a href="#classic">Cl√°sicas</a>
    <a href="#mexico">Cine mexicano</a>
  </nav>

  <div class="search-box">
    <input id="search" placeholder="Buscar pel√≠culas o series...">
  </div>
</header>

<main id="app"></main>

<script>
const API_KEY = "5b4ad82505bd1853a5256c1db2d4b330";
const IMG = "https://image.tmdb.org/t/p/w500";
const app = document.getElementById("app");

window.addEventListener("load", router);
window.addEventListener("hashchange", router);

/* ROUTER */
function router(){
  const h = location.hash;

  if(h.startsWith("#movie/") || h.startsWith("#tv/")){
    const [t,id] = h.replace("#","").split("/");
    detalle(t,id);
  }else if(h.startsWith("#search/")){
    buscar(decodeURIComponent(h.split("/")[1]));
  }else{
    catalogo(h.replace("#","") || "new");
  }
}

/* B√öSQUEDA */
document.getElementById("search").addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    location.hash = "#search/"+encodeURIComponent(e.target.value);
  }
});

function buscar(q){
  app.innerHTML = `<h2>üîé Resultados para "${q}"</h2><div class="grid" id="grid"></div>`;
  fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&language=es-MX&query=${q}`)
    .then(r=>r.json())
    .then(d=>{
      const g = document.getElementById("grid");
      d.results.forEach(i=>{
        if(!i.poster_path) return;
        const c=document.createElement("div");
        c.className="card";
        c.innerHTML=`<img src="${IMG+i.poster_path}"><span>${i.title||i.name}</span>`;
        c.onclick=()=>location.hash=`#${i.media_type}/${i.id}`;
        g.appendChild(c);
      });
    });
}

/* CAT√ÅLOGO */
function catalogo(cat){
  app.innerHTML = `<h2>${titulo(cat)}</h2><div class="grid" id="grid"></div>`;
  cargar(cat,1);
}

function cargar(cat,page){
  const urls={
    new:`discover/movie?sort_by=popularity.desc`,
    classic:`discover/movie?primary_release_date.lte=1980`,
    mexico:`discover/movie?with_original_language=es&region=MX&primary_release_date.lte=1970`,
    series:`discover/tv?sort_by=popularity.desc`,
    anime:`discover/tv?with_genres=16&with_original_language=ja`
  };

  fetch(`https://api.themoviedb.org/3/${urls[cat]}&api_key=${API_KEY}&language=es-MX&page=${page}`)
    .then(r=>r.json())
    .then(d=>{
      const g=document.getElementById("grid");
      d.results.forEach(i=>{
        if(!i.poster_path) return;
        const c=document.createElement("div");
        c.className="card";
        c.innerHTML=`<img src="${IMG+i.poster_path}"><span>${i.title||i.name}</span>`;
        c.onclick=()=>location.hash=`#${cat==="series"||cat==="anime"?"tv":"movie"}/${i.id}`;
        g.appendChild(c);
      });
      if(page<8) cargar(cat,page+1); // MUCH√çSIMO contenido
    });
}

function titulo(c){
  return{
    new:"üé• Pel√≠culas nuevas",
    anime:"üéå Anime",
    series:"üì∫ Series",
    classic:"üéû Cl√°sicos",
    mexico:"üá≤üáΩ Cine mexicano"
  }[c];
}

/* DETALLE */
function detalle(type,id){
  Promise.all([
    fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}&language=es-MX`).then(r=>r.json()),
    fetch(`https://api.themoviedb.org/3/${type}/${id}/credits?api_key=${API_KEY}`).then(r=>r.json())
  ]).then(([d,c])=>{
    const director = c.crew.find(p=>p.job==="Director") || {};
    app.innerHTML=`
      <div class="detail">
        <button onclick="history.back()">‚¨Ö Volver</button>
        <div class="detail-header">
          <img src="${IMG+d.poster_path}">
          <div class="detail-info">
            <h2>${d.title||d.name}</h2>
            <p>${d.overview||"Sin descripci√≥n."}</p>
            <p>
              <span class="badge">${(d.release_date||d.first_air_date||"").slice(0,4)}</span>
              <span class="badge">${d.runtime||"?"} min</span>
            </p>
            <p><strong>Director:</strong> ${director.name||"No disponible"}</p>
            <p><strong>G√©neros:</strong> ${d.genres.map(g=>g.name).join(", ")}</p>
          </div>
        </div>

        <h3>‚≠ê Tu puntuaci√≥n</h3>
        <div class="stars" id="stars"></div>

        <h3>üìù Tu rese√±a</h3>
        <textarea id="review"></textarea>
        <button onclick="guardar(${id})">Guardar</button>
      </div>
    `;
    estrellas(id);
    document.getElementById("review").value = localStorage.getItem("review_"+id)||"";
  });
}

/* ESTRELLAS */
function estrellas(id){
  const s=document.getElementById("stars");
  s.innerHTML="";
  let r=localStorage.getItem("rating_"+id)||0;
  for(let i=1;i<=5;i++){
    const e=document.createElement("span");
    e.innerText="‚òÖ";
    if(i<=r) e.classList.add("active");
    e.onclick=()=>{localStorage.setItem("rating_"+id,i);estrellas(id);}
    s.appendChild(e);
  }
}

function guardar(id){
  localStorage.setItem("review_"+id,document.getElementById("review").value);
  alert("Rese√±a guardada");
}
</script>

</body>
</html>




