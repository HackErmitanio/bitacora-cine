<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Escena 24</title>

<style>
:root {
  --bg: #0b1c2d;
  --panel: #071421;
  --accent: #cfae70;
  --text: #f1f1f1;
}

body {
  margin: 0;
  font-family: "Georgia", serif;
  background: var(--bg);
  color: var(--text);
}

header {
  background: linear-gradient(180deg, #071421, #020a12);
  padding: 30px;
  text-align: center;
}

header h1 {
  margin: 0;
  font-size: 2.5rem;
  letter-spacing: 2px;
}

header p {
  opacity: .8;
  margin-top: 5px;
}

nav {
  margin-top: 20px;
  display: flex;
  justify-content: center;
  gap: 25px;
  flex-wrap: wrap;
}

nav a {
  color: var(--accent);
  text-decoration: none;
  font-weight: bold;
}

nav a:hover {
  text-decoration: underline;
}

main {
  padding: 40px;
}

h2 {
  border-left: 5px solid var(--accent);
  padding-left: 10px;
  margin-bottom: 20px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
  gap: 22px;
}

.card {
  text-align: center;
}

.card img {
  width: 100%;
  border-radius: 12px;
  cursor: pointer;
  transition: transform .3s, box-shadow .3s;
}

.card img:hover {
  transform: scale(1.06);
  box-shadow: 0 10px 25px rgba(0,0,0,.6);
}

.card span {
  font-size: .85rem;
  opacity: .8;
}

/* DETALLE */
.detail {
  max-width: 1000px;
  margin: auto;
}

.detail img {
  width: 280px;
  float: left;
  margin-right: 30px;
  border-radius: 14px;
}

.stars span {
  font-size: 28px;
  cursor: pointer;
  color: gray;
}

.stars span.active {
  color: gold;
}

textarea {
  width: 100%;
  min-height: 120px;
  background: #020a12;
  color: white;
  border: 1px solid #333;
  padding: 10px;
}

button {
  background: var(--accent);
  color: black;
  border: none;
  padding: 10px 16px;
  margin-top: 10px;
  cursor: pointer;
}

button:hover {
  opacity: .85;
}
</style>
</head>

<body>

<header>
  <h1>ESCENA 24</h1>
  <p>Archivo cinematogr√°fico ¬∑ cr√≠tica ¬∑ memoria</p>

  <nav>
    <a href="#new">Pel√≠culas nuevas</a>
    <a href="#anime">Anime</a>
    <a href="#series">Series</a>
    <a href="#classic">Cine cl√°sico</a>
    <a href="#mexico">Cine de Oro Mexicano</a>
  </nav>
</header>

<main id="app"></main>

<script>
const API_KEY = "5b4ad82505bd1853a5256c1db2d4b330";
const IMG = "https://image.tmdb.org/t/p/w500";
const app = document.getElementById("app");

window.addEventListener("load", router);
window.addEventListener("hashchange", router);

function router() {
  const h = location.hash;

  if (h.startsWith("#movie/") || h.startsWith("#tv/")) {
    const [t, id] = h.replace("#","").split("/");
    detalle(t, id);
  } else {
    catalogo(h.replace("#","") || "new");
  }
}

/* ---------------- CAT√ÅLOGO ---------------- */

function catalogo(cat) {
  app.innerHTML = `<h2>${tit(cat)}</h2><div class="grid" id="grid"></div>`;
  cargar(cat, 1);
}

function cargar(cat, page) {
  const urls = {
    new: `discover/movie?sort_by=popularity.desc&primary_release_date.gte=2021`,
    classic: `discover/movie?primary_release_date.lte=1979`,
    mexico: `discover/movie?with_original_language=es&region=MX&primary_release_date.lte=1970`,
    series: `discover/tv?sort_by=popularity.desc`,
    anime: `discover/tv?with_genres=16&with_original_language=ja`
  };

  fetch(`https://api.themoviedb.org/3/${urls[cat]}&api_key=${API_KEY}&language=es-MX&page=${page}`)
    .then(r => r.json())
    .then(d => {
      const g = document.getElementById("grid");
      d.results.forEach(i => {
        if (!i.poster_path) return;
        const c = document.createElement("div");
        c.className = "card";
        c.innerHTML = `
          <img src="${IMG + i.poster_path}">
          <span>${(i.title || i.name)}</span>
        `;
        c.onclick = () => {
          location.hash = `#${cat === "series" || cat === "anime" ? "tv":"movie"}/${i.id}`;
        };
        g.appendChild(c);
      });

      if (page < 6) cargar(cat, page + 1);
    });
}

function tit(c) {
  return {
    new: "üé• Pel√≠culas nuevas",
    anime: "üéå Anime (series japonesas)",
    series: "üì∫ Series",
    classic: "üéû Cine cl√°sico",
    mexico: "üá≤üáΩ Cine de Oro Mexicano"
  }[c];
}

/* ---------------- DETALLE ---------------- */

function detalle(type, id) {
  fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}&language=es-MX`)
    .then(r => r.json())
    .then(d => {
      app.innerHTML = `
        <div class="detail">
          <button onclick="history.back()">‚¨Ö Volver</button>
          <h2>${d.title || d.name}</h2>
          <img src="${IMG + d.poster_path}">
          <p><strong>A√±o:</strong> ${(d.release_date || d.first_air_date || "").slice(0,4)}</p>
          <p>${d.overview || "Sin descripci√≥n disponible."}</p>

          <h3>‚≠ê Tu puntuaci√≥n</h3>
          <div class="stars" id="stars"></div>

          <h3>üìù Rese√±a</h3>
          <textarea id="review"></textarea>
          <button onclick="guardar(${id})">Guardar rese√±a</button>
        </div>
      `;
      estrellas(id);
      document.getElementById("review").value = localStorage.getItem("review_"+id) || "";
    });
}

/* ---------------- RATING ---------------- */

function estrellas(id) {
  const s = document.getElementById("stars");
  s.innerHTML = "";
  let r = localStorage.getItem("rating_"+id) || 0;

  for (let i=1;i<=5;i++) {
    const e = document.createElement("span");
    e.innerText = "‚òÖ";
    if (i <= r) e.classList.add("active");
    e.onclick = () => {
      localStorage.setItem("rating_"+id, i);
      estrellas(id);
    };
    s.appendChild(e);
  }
}

function guardar(id) {
  localStorage.setItem("review_"+id, document.getElementById("review").value);
  alert("Rese√±a guardada");
}
</script>

</body>
</html>




